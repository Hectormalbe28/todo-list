<!-- Contenedor principal para mejor responsive -->
<ion-grid fixed>
  <ion-row class="ion-justify-content-center">
    <ion-col size="12" size-sm="12" size-md="8" size-lg="6">

      <!-- Título de la agenda -->
      <ion-card class="ion-padding">
        <ion-card-header>
          <ion-card-title class="ion-text-center">
            <strong>Agenda</strong>
          </ion-card-title>
          <ion-card-subtitle class="ion-text-center">
            Tareas para el {{ todayDate() }}
          </ion-card-subtitle>
        </ion-card-header>

        <ion-card-content>
          <!-- Campo de entrada para agregar nueva tarea -->
          <ion-item>
            <ion-input
              placeholder="Crea una nueva tarea"
              [formControl]="newTaskCtrl"
              (keydown.enter)="addTask()">
            </ion-input>
            <ion-button (click)="addTask()" fill="solid" color="primary">
              <ion-icon name="add-circle-outline"></ion-icon>
            </ion-button>
          </ion-item>
          <!-- Mensaje de validación -->
          <ion-text color="danger" *ngIf="newTaskCtrl.invalid && newTaskCtrl.touched">
            <p *ngIf="newTaskCtrl.errors?.['required']">La tarea no puede estar vacía.</p>
            <p *ngIf="newTaskCtrl.errors?.['minlength']">Debe tener al menos 3 caracteres.</p>
            <p *ngIf="newTaskCtrl.errors?.['maxlength']">No puede superar los 30 caracteres.</p>
          </ion-text>
        </ion-card-content>
      </ion-card>

      <!-- Lista de tareas -->
      <ion-list class="full-width">
        <ion-item *ngFor="let task of tasks()" class="task-item full-width">
          <!-- Checkbox para marcar tarea como completada -->
          <ion-checkbox
            slot="start"
            *ngIf="!task.editing"
            [checked]="task.completed"
            (ionChange)="toggleTaskCompletion(task.id)">
          </ion-checkbox>

          <!-- Vista de tarea cuando no está en modo edición -->
          <ion-label *ngIf="!task.editing" (dblclick)="activateEditMode(task.id)" [class.completed]="task.completed">
            {{ task.name }}
          </ion-label>

          <!-- Modo edición: campo de entrada para modificar la tarea -->
          <ion-input
            *ngIf="task.editing"
            [value]="task.name"
            (keydown.enter)="editTask(task.id, $event)"
            class="edit-input">
          </ion-input>

          <!-- Botón para eliminar la tarea -->
          <ion-button *ngIf="!task.editing" fill="clear" color="primary" (click)="deleteTask(task.id)">
            <ion-icon name="trash-outline"></ion-icon>
          </ion-button>
        </ion-item>
      </ion-list>

    </ion-col>
  </ion-row>
</ion-grid>
